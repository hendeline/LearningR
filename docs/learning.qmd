---
title: "Reproducible Document"
author: "Line Sahlholdt Hansen"
format: html
---

Quarto er en slags ny "R markdown" - Quarto er nyt, så det henvises somme tider til som R markdown stadig.
I Quarto er tekst ikke læst som kode (som normalt i R). Det virker ikke bare at skrive kode som tekst i R. Den læser det ikke som kode, når man er i Quarto. Man skal derfor indsætte en "code chunk", som indsættes ved at finde den ved at søge i menuen, som kommer frem ved at skrive "cmnd+shift+p". 

Under "format" øverst i dokumentet kan skiftes mellem "html", "docx" og "pdf" - det ændrer hvordan outputtet vises, når man trykker gem og derefter "Render". 

Under tandhjulikonet kan visningen af dokumentet ændres - fx enten på hjemmeside eller bare i siden af R. 
"Help" --> "keyboard shortcut help" giver oversigt over genveje. 

Code chunks kan navngives som fx herunder "r setup", og navne kan ikke genbruges i samme dokument. Kan ses under "outline" som kursiv tekst. "Overskrifterne" er lavet med fx ## (se sektion 15.8 for flere formateringsmuligheder).

"option + i" = |
```{r setup}
#| message: false
#| warning: false
library(tidyverse)

post_meal_data <- read_csv2(here::here("data/post-meal-insulin.csv"))
```

## Writing R code

```{r}
2+2
```

Mange funktioner er ikke default-funktioner i R, når man åbner det. Actions/funktioner kan hentes i pakker. 


Alt i R er et "object", og man kan selv oprette objekter ved at "tildele" noget med "<-":

weight_kilos <- 100
weight_kilos

Der findes forskellige typer datatyper. Se "15.6" i undervisningsmateriale. 
Når man skriver "" betyder det, at man leder efter ...?


Functions (markeres med parentes ()) i R er noget, der giver en "action" - man gør noget med noget.
Prøver head-action herunder:

head(airquality)
head


------------ Exercise 15.9 -----------

## About me
- Line Sahlholdt Hansen
- Steno Diabetes Center Aarhus
- Aarhus Universitet

I am a **PhD student** conducting a study on *optimizing follow up after pregnancies affected by gestational diabetes*. 

## Simple code
```{r}
3*3
```

----------- Punkt 16: Version control with Git ------------

Git kan bruges til at registrere/logge ændringer løbende, så man ikke ender med mange versioner af et dokument. 
Klik "git" --> "commit". Kan skrive under "commmit message" hvorfor man ændrer noget. Før man kan gøre det, skal man vælge hvilke filer, man vil tracke ved at "add"e dem. Sæt fluben ved dokumentet og vælg "commit", tror jeg - se online i undervisningsdokument. 

Man kan bruge gitignore til fx personfølsomme dokumenter mv. Man kan bruge denne funktion til at definere hvilke dokumenter, der er tale om: usethis::use_git_ignore(c("*.html", "*_files/"))
Hermed har man sagt, at filer af denne type skal i gitignore. Disse uploades dermed ikke til github? Bruges fx ved dokumenter med personfølsomme data.

## Testing for Git
Dette er en del af øvelsen ved punkt 16. Jeg skal øve at registrere ændringer i git. 

------------ DAG 2 -------------
Punkt 17. 
Skriver kode i console for at downloade data, som er kopieret fra punkt 17.3 på hjemmesiden:
# download.file(
#  url = "https://zenodo.org/records/4989220/files/Eliasson_data2.csv?download=1",
#  destfile = here::here("data/post-meal-insulin.csv")
#)
Dette giver datasættet "post-meal-insulin" i data-mappen. 

Har under "setup" øverst i dokumentet tilegnet dette datasæt navnet: post_meal_data 

Forkortelsen "chr" = characters (bogstaver) og "dbl" (decible?) = tal. Bruges somme tider når datasæt vises (fx ved glimpse-funktion).

Personfølsomme data eller meget store data skal i gitignore!

Hvad skal vises fra code chunks efter render:
"option + i" = |
Man kan vælge, hvad der skal vises i sit render-output. Se hvad jeg har skrevet under "setup"-code chunk øverst i dokumentet: "#| message: false" - default er at den er "true", hvilket betyder, at alle messages vises. Når den skiftes til false, vises ingen beskeder. Det samme gælder for "warning". Dette vil kun gælde for outpus fra denne specifikke code chunk. Man kan gøre sådan, at det gælder for alle code chunks - se dette på undervisningsdokument.



##Showing the data
```{r}
post_meal_data

glimpse(post_meal_data)
```


---- Om at visualisere data - sektion 18 -------

## Plot one continous variable

Undersøger distribution of BMI within diabetes patients: 
aes = æstetik - kan tilskrive "x" at vise en variabelfx BMI
geom siger noget om hvilken type plot, man vil vise
Ved manglende værdier kan man skrive "na.rm=F" = "NA remove = False" - så beholder den datarækker med mangelende værdier. R fjerner automatisk disse ellers.
"fig-cap" giver figure caption under figuren
"label" giver reference i teksten, så hvis man kører musen over denne tekst, vil den vise figuren. 

```{r}
#| fig-cap: "Distribution of BMI"
#| label: fig-bmi-histo
ggplot(post_meal_data,aes(x = BMI)) +
  geom_histogram(na.rm=F)
```
Pga label kan man skrive følgende og referere til figuren:
See @fig-bmi-histo


ØVELSE I SEKTION 18
## Exercise: discrete plots

```{r}
#| fig-cap: "Test plot for glykemi"
#| label: fig-glykemi-bar
ggplot(post_meal_data, aes(x = glykemi)) +
  geom_bar()
```

See @fig-glykemi-bar above for a cool plot!

Ved continous data kan man plotte to variabler (en på hhv x- og y-aksen). Øvelsen herover er afbilledet af "discrete" data med kun en variabel. 

## Plotting to discrete variables
fill vil gerne have chr-inputs, men i dette tilfælde herunder er fill (glykemi) numbers. Derfor ændres til "as.charactor"

```{r}
ggplot(post_meal_data, aes(x = Group, fill = as.character(glykemi))) + 
  geom_bar()

```
Koden herover viser barrene i samme kolonner. Hvis man vil skille dem ad kan man skrive følgende i geom_bar-funktionen, så de vises adskilt:

```{r}
ggplot(post_meal_data, aes(x = Group, fill = as.character(glykemi))) + 
  geom_bar(position=position_dodge())
```





